(this.webpackJsonpezbuild=this.webpackJsonpezbuild||[]).push([[0],{106:function(e,t,n){"use strict";n.r(t);var a,r=n(0),c=n.n(r),i=n(11),o=n.n(i),u=(n(84),n(85),n(86),n(87),n(110)),l=n(61),s=n(62),p=n(60),d=n(57),m=n(5),f=n.n(m),v=n(8),h=n(67);!function(e){e.azure="https://management.azure.com/user_impersonation",e.devops="499b84ac-1321-427f-aa17-267ca6975798/user_impersonation"}(a||(a={}));var b="https://management.azure.com/tenants?api-version=2019-06-01",E=function(e){return!(!e||!e.length)&&(-1!==e.indexOf("consent_required")||-1!==e.indexOf("interaction_required")||-1!==e.indexOf("login_required"))},g=new h.a({auth:{clientId:"0423268c-4035-4f17-a955-808798af30ad",authority:"https://login.microsoftonline.com/common",validateAuthority:!0},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1}});function y(){return g.getAccount()}function j(e,t){return O.apply(this,arguments)}function O(){return(O=Object(v.a)(f.a.mark((function e(t,n){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a={scopes:[n],authority:"https://login.microsoftonline.com/"+t},g.getAccount()){e.next=4;break}return e.next=4,g.loginPopup(a);case 4:return e.prev=4,e.next=7,g.acquireTokenSilent(a);case 7:return e.abrupt("return",e.sent.accessToken);case 10:if(e.prev=10,e.t0=e.catch(4),!E(e.t0)){e.next=20;break}return e.next=15,g.loginPopup(a);case 15:return e.next=17,j(t,n);case 17:return e.abrupt("return",e.sent);case 20:return e.next=22,g.acquireTokenPopup(a);case 22:return e.abrupt("return",e.sent.accessToken);case 23:case"end":return e.stop()}}),e,null,[[4,10]])})))).apply(this,arguments)}function w(){return I.apply(this,arguments)}function I(){return(I=Object(v.a)(f.a.mark((function e(){var t,n,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j("common",a.azure);case 2:return t=e.sent,e.next=5,fetch(b,{headers:{Authorization:"Bearer ".concat(t)}});case 5:return n=e.sent,e.next=8,n.json();case 8:return r=e.sent,e.abrupt("return",r.value);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return k.apply(this,arguments)}function k(){return(k=Object(v.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(t,a.devops);case 2:return n=e.sent,e.abrupt("return",{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e,t,n,a){return z.apply(this,arguments)}function z(){return(z=Object(v.a)(f.a.mark((function e(t,n,a,r){var c,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c="https://dev.azure.com/".concat(n,"/").concat(a),e.next=3,x(t);case 3:return i=e.sent,e.next=6,fetch(c,{method:"POST",mode:"cors",headers:i,body:JSON.stringify(r)}).then((function(e){return e.json()}));case 6:return o=e.sent,e.abrupt("return",o);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(e,t,n){return C.apply(this,arguments)}function C(){return(C=Object(v.a)(f.a.mark((function e(t,n,a){var r,c,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://dev.azure.com/".concat(n,"/").concat(a),e.next=3,x(t);case 3:return c=e.sent,e.next=6,fetch(r,{method:"GET",mode:"cors",headers:c}).then((function(e){return e.json()}));case 6:return i=e.sent,e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(e,t,n){return A.apply(this,arguments)}function A(){return(A=Object(v.a)(f.a.mark((function e(t,n,a){var r,c,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="https://vsrm.dev.azure.com/".concat(n,"/").concat(a),e.next=3,x(t);case 3:return c=e.sent,e.next=6,fetch(r,{method:"GET",mode:"cors",headers:c}).then((function(e){return e.json()}));case 6:return i=e.sent,e.abrupt("return",i);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e,t){return B.apply(this,arguments)}function B(){return(B=Object(v.a)(f.a.mark((function e(t,n){var r,c,i;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j(t,a.devops);case 2:return r=e.sent,e.next=5,fetch("https://app.vssps.visualstudio.com/".concat(n),{headers:{Authorization:"Bearer ".concat(r)}});case 5:return c=e.sent,e.next=8,c.json();case 8:return i=e.sent,e.abrupt("return",i);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var F={profileService:{get:function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_(t,"_apis/profile/profiles/me?api-version=5.1");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},accountService:{listAccounts:function(){var e=Object(v.a)(f.a.mark((function e(t,n){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_(t,"_apis/accounts?memberId=".concat(n,"&api-version=5.1"));case 2:return a=e.sent,e.abrupt("return",a.value);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},repositoryService:{listRepositories:function(){},listBranches:function(){var e=Object(v.a)(f.a.mark((function e(t,n,a,r){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(t,n,"".concat(a,"/_apis/git/repositories/").concat(r,"/stats/branches?api-version=5.1"));case 2:return c=e.sent,e.abrupt("return",c.value);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}()},projectService:{list:function(){var e=Object(v.a)(f.a.mark((function e(t,n){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(t,n,"_apis/projects?api-version=5.1");case 2:return a=e.sent,e.abrupt("return",a.value);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},buildService:{listDefinitions:function(){var e=Object(v.a)(f.a.mark((function e(t,n,a){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(t,n,"".concat(a,"/_apis/build/definitions?includeAllProperties=true&includeLatestBuilds=true&api-version=5.1"));case 2:return r=e.sent,e.abrupt("return",r.value);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),listBuilds:function(){var e=Object(v.a)(f.a.mark((function e(t,n,a){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(t,n,"".concat(a,"/_apis/build/builds?maxBuildsPerDefinition=1&deletedFilter=excludeDeleted&api-version=5.1"));case 2:return r=e.sent,e.abrupt("return",r.value);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),listHistory:function(){var e=Object(v.a)(f.a.mark((function e(t,n,a,r){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(t,n,"".concat(a,"/_apis/build/builds?definitions=").concat(r,"&api-version=5.1"));case 2:return c=e.sent,e.abrupt("return",c.value);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a,r){return e.apply(this,arguments)}}(),trigger:function(){var e=Object(v.a)(f.a.mark((function e(t,n,a){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S(t,n,"".concat(a.project.id,"/_apis/build/builds?ignoreWarnings=false&api-version=5.1"),a);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()},releaseService:{listDefinitions:function(){var e=Object(v.a)(f.a.mark((function e(t,n,a){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(t,n,"".concat(a,"/_apis/release/definitions?api-version=5.1"));case 2:return r=e.sent,e.abrupt("return",r.value);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),listApprovals:function(){var e=Object(v.a)(f.a.mark((function e(t,n,a){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(t,n,"".concat(a,"/_apis/release/approvals?api-version=5.1"));case 2:return r=e.sent,e.abrupt("return",r.value);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()}},P=Object(d.a)({tenantFilter:JSON.parse(localStorage.getItem("tenantFilter"))||[],tenants:[],tenantId:null,account:y(),organizations:[],organizationId:null,projects:[],projectId:null,projectService:F.projectService,buildService:F.buildService,repositoryService:F.repositoryService,releaseService:F.releaseService,profileService:F.profileService,accountService:F.accountService}),T=P.action,R=P.useSquawk,L=P.pending,q=P.usePending,G=n(68),V=n(121),M=n(17),J=V.a.create({className:"recipe-toaster",position:M.a.TOP}),Z=function(e,t,n){J.show({message:e,intent:t,icon:n})},Q=function(e,t){return e>t?1:e<t?-1:0},W=function(e,t){return(e.isBaseVersion?-1:1)-(t.isBaseVersion?-1:1)||new Date(t.commit.committer.date).valueOf()-new Date(e.commit.committer.date).valueOf()},H=function(e,t){return Q(e.displayName,t.displayName)},Y=function(e,t){return Q(e.accountName,t.accountName)},$=function(e,t){return Q(e.name,t.name)},K=function(e,t){return Q(e.path,t.path)||Q(e.name,t.name)},U=function(e,t){return Q(e.path,t.path)||Q(e.name,t.name)},X=function(){var e=window.location.hash.substring(1).split("/").filter((function(e){return""!==e}));return{tenantId:e[0],organizationId:e[1],projectId:e[2],page:e[3]||"builds"}},ee=T((function(e,t){if(e.tenantFilter.some((function(e){return e.tenantId===t.tenantId})))return Z("That tenant was already filtered, sorry about that","warning"),{};Z("Filter added, please reload page if the filter fails to apply","success");var n=[].concat(Object(G.a)(e.tenantFilter),[t]);return localStorage.setItem("tenantFilter",JSON.stringify(n)),{tenantFilter:n}})),te=T(function(){var e=Object(v.a)(f.a.mark((function e(t){var n,a,r,c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(["tenants","organizations","projects"],!0),e.next=3,w();case 3:return e.t0=function(e){return!t.tenantFilter.some((function(t){return t.tenantId===e.tenantId}))},e.t1=H,n=e.sent.filter(e.t0).sort(e.t1),L(["tenants","organizations","projects"],!1),a=X(),r=a.tenantId,c=n.length>0?n.some((function(e){return e.tenantId===r}))?r:n[0].tenantId:null,e.abrupt("return",{tenants:n,account:y(),tenantId:c});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ne=T(function(){var e=Object(v.a)(f.a.mark((function e(t,n){var a,r,c,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return L(["organizations","projects"],!0),e.next=3,t.profileService.get(n);case 3:return a=e.sent,e.next=6,t.accountService.listAccounts(n,a.id);case 6:return e.t0=Y,r=e.sent.sort(e.t0),c=X(),i=c.organizationId,o=r.length>0?r.some((function(e){return e.accountName===i}))?i:r[0].accountName:null,L(["organizations","projects"],!1),e.abrupt("return",{organizations:r,tenantId:n,organizationId:o});case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),ae=T(function(){var e=Object(v.a)(f.a.mark((function e(t,n){var a,r,c,i,o,u,l;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.projectService,r=n.tenantId,c=n.organizationId,L(["projects"],!0),e.prev=3,e.next=6,a.list(r,c);case 6:return e.t0=$,i=e.sent.sort(e.t0),o=X(),u=o.projectId,l=i.length>0?i.some((function(e){return e.id===u}))?u:i[0].id:null,e.abrupt("return",{tenantId:r,projects:i,organizationId:c,projectId:l});case 13:e.prev=13,e.t1=e.catch(3);case 15:return e.prev=15,L(["projects"],!1),e.finish(15);case 18:return e.abrupt("return",{});case 19:case"end":return e.stop()}}),e,null,[[3,13,15,18]])})));return function(t,n){return e.apply(this,arguments)}}()),re=T(function(){var e=Object(v.a)(f.a.mark((function e(t,n){var a,r,c,i,o,u,l,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.tenantId){e.next=8;break}return e.next=3,te();case 3:if(a=e.sent,r=a.tenantId){e.next=7;break}return e.abrupt("return",{});case 7:n.tenantId=r;case 8:if(n.organizationId){e.next=16;break}return e.next=11,ne(n.tenantId);case 11:if(c=e.sent,i=c.organizationId){e.next=15;break}return e.abrupt("return",{});case 15:n.organizationId=i;case 16:if(n.projectId){e.next=24;break}return e.next=19,ae({tenantId:n.tenantId,organizationId:n.organizationId});case 19:if(o=e.sent,u=o.projectId){e.next=23;break}return e.abrupt("return",{});case 23:n.projectId=u;case 24:return l=X(),s=l.page,window.location.hash=[n.tenantId,n.organizationId,n.projectId,s].join("/"),e.abrupt("return",n);case 27:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());y()&&re({});var ce,ie,oe,ue=n(59),le=function(e){return e.loading?c.a.createElement("div",null,c.a.createElement(ue.a,{size:ue.a.SIZE_SMALL})):0===e.items.length?c.a.createElement("div",{className:"bp3-select"},c.a.createElement("select",{defaultValue:"nodata"},c.a.createElement("option",{value:"nodata"},e.noData))):c.a.createElement("div",{className:"bp3-select"},c.a.createElement("select",{value:e.value,onChange:function(t){var n=t.currentTarget.value;return e.onChange(n)}},e.items.map((function(e){return c.a.createElement("option",{key:e.key,value:e.value},e.text)}))))},se=function(){var e=R("organizations","tenantId","organizationId"),t=e.organizations,n=e.tenantId,a=e.organizationId,r=q("organizations"),i=t.map((function(e){return{key:e.accountId,value:e.accountName,text:e.accountName}}));return c.a.createElement(le,{loading:r,value:a||void 0,items:i,onChange:function(e){return function(e,t){re({tenantId:e,organizationId:t})}(n,e)},noData:"No Azure DevOps organizations found in tenant"})},pe=function(){var e=R("projects","tenantId","organizationId","projectId"),t=e.projects,n=e.tenantId,a=e.organizationId,r=e.projectId,i=q("projects"),o=t.map((function(e){return{key:e.id,value:e.id,text:e.name}}));return c.a.createElement(le,{items:o,onChange:function(e){return function(e,t,n){re({tenantId:e,organizationId:t,projectId:n})}(n,a,e)},loading:i,noData:"No projects found",value:r||void 0})},de=function(){var e=Object(v.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:re({tenantId:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),me=function(){var e=R("tenants","tenantId"),t=e.tenants,n=e.tenantId,a=q("tenants"),r=t.map((function(e){return{key:e.tenantId,value:e.tenantId,text:"".concat(e.displayName," (").concat(e.domains[e.domains.length-1],")")}}));return c.a.createElement(le,{loading:a,value:n||void 0,items:r,onChange:function(e){return de(e)},noData:"No Azure tenants found"})},fe=function(){return c.a.createElement(u.a,null,c.a.createElement(l.a,null,c.a.createElement(s.a,null,"ez-build"),c.a.createElement(p.a,null),c.a.createElement(me,null),c.a.createElement(p.a,null),c.a.createElement(se,null),c.a.createElement(p.a,null),c.a.createElement(pe,null)))},ve=n(13),he=n(120),be=n(45),Ee=n(113),ge=n(111),ye=function(e){return e.visible?c.a.createElement("tr",null,c.a.createElement("td",{colSpan:e.columns,className:"cell-center"},c.a.createElement(ge.a,{description:e.text}))):null},je=function(e){return c.a.createElement("thead",null,c.a.createElement("tr",null,e.children))},Oe=n(58),we=n(112);!function(e){e.Enabled="enabled",e.Disabled="disabled"}(ce||(ce={})),function(e){e.Build="build"}(ie||(ie={})),function(e){e.Manual="manual",e.Schedule="schedule"}(oe||(oe={}));var Ie=function(e){return Object(r.useMemo)((function(){return e?new Date(e).toLocaleString("sv-SE"):""}),[e])},xe=function(e){var t={};if(!e)return t;for(var n=0,a=Object.keys(e);n<a.length;n++){var r=a[n];t[r]=e[r].value}return t},ke=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t<0||t!==Math.floor(t))throw new Error("Expected count to be a positive integer");for(var a=[];t-- >0;)a.push(e),e+=n;return a},Se=n(18),ze=n(119),Ne=function(e){var t=e.text,n=e.element;return c.a.createElement(ze.a,{inheritDarkTheme:!0,content:t},n)},Ce=function(e){var t=e.result,n=e.status;if("completed"!==n){var a="cancelling"===n?"stop":"inProgress"===n?"play":"notStarted"===n?"time":void 0;return c.a.createElement(Ne,{text:n,element:c.a.createElement(Se.a,{icon:a})})}var r="failed"===t?"error":"canceled"===t?"ban-circle":"partiallySucceeded"===t?"tick":"succeeded"===t?"tick":void 0,i="succeeded"===t?"success":"partiallySucceeded"===t?"warning":"danger";return c.a.createElement(Ne,{text:t,element:c.a.createElement(Se.a,{icon:r,intent:i})})},De=Object(r.memo)((function(e){var t=e.item,n=Ie(t.queueTime),a=Ie(t.finishTime);return c.a.createElement("tr",null,c.a.createElement("td",null,t.buildNumber),c.a.createElement("td",null,c.a.createElement(Ce,{result:t.result,status:t.status})),c.a.createElement("td",null,n),c.a.createElement("td",null,a),c.a.createElement("td",null,t.sourceBranch))})),Ae=function(e){return e.visible?c.a.createElement("tr",null,c.a.createElement("td",{colSpan:e.columns,className:"cell-center"},c.a.createElement(ue.a,{size:e.size}))):null},_e=n(32),Be=function(e){return e.tooltip?c.a.createElement(ze.a,{inheritDarkTheme:!0,content:e.tooltip},c.a.createElement(_e.b,e,e.children)):c.a.createElement(_e.b,e,e.children)},Fe=n(1),Pe=function(e){return c.a.createElement("div",{className:Fe.a.DIALOG_HEADER},e.content)},Te=function(e){return c.a.createElement("div",{className:Fe.a.DIALOG_BODY},e.children)},Re=function(e){return c.a.createElement("div",{className:Fe.a.DIALOG_FOOTER},c.a.createElement("div",{className:Fe.a.DIALOG_FOOTER_ACTIONS},e.children))},Le=n(44),qe=function(e){var t=Object(r.useState)(!1),n=Object(ve.a)(t,2),a=n[0],i=n[1],o=R("buildService","organizationId","projectId","tenantId"),u=o.buildService,l=o.organizationId,s=o.projectId,p=o.tenantId,d=Object(Le.b)(u.listHistory,[]),m=Object(ve.a)(d,3),h=m[0],b=m[1],E=m[2],g=b===Le.a.Pending,y=function(){var t=Object(v.a)(f.a.mark((function t(){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i(!0),E(p,l,s,e.id);case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return c.a.createElement(c.a.Fragment,null,c.a.createElement(Be,{tooltip:"View history",icon:"history",onClick:y}),c.a.createElement(we.a,{isOpen:a,onClose:function(){return i(!1)},className:"bp3-dark large-dialog scroll-dialog"},c.a.createElement(Pe,{content:"Build history for ".concat(e.name)}),c.a.createElement(Te,null,c.a.createElement(Be,{icon:"refresh",onClick:y,tooltip:"Refresh"}),c.a.createElement(Ee.a,null,c.a.createElement(je,null,c.a.createElement("th",null,"ID"),c.a.createElement("th",null,"Result"),c.a.createElement("th",null,"Queued"),c.a.createElement("th",null,"Completed"),c.a.createElement("th",null,"Branch")),c.a.createElement("tbody",null,c.a.createElement(Ae,{columns:5,visible:g,size:100}),c.a.createElement(ye,{columns:5,visible:!g&&0===h.length,text:"Found no previous builds"}),h.map((function(e){return c.a.createElement(De,{key:e.id,item:e})})))))))},Ge=n(114),Ve=n(115),Me=function(e){return function(t){return t.hidden?null:c.a.createElement(e,t,t.children)}},Je=Me(ge.a),Ze=(Me(Ge.a),Me(Ve.a)),Qe=Me(ue.a),We=n(65);function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}var Ye=function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(n,!0).forEach((function(t){Object(We.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{},t)},$e=function(e){var t=e.loading,n=e.branches,a=e.onChange;return c.a.createElement(Ze,{label:"Branch",labelFor:"branches",hidden:t||0===n.length},c.a.createElement(Ge.a,{id:"branches",fill:!0,onChange:function(e){var t=e.currentTarget.value;return a(t)}},n.map((function(e){return c.a.createElement("option",{key:e.name,value:e.name},e.name," (",e.aheadCount," ahead,"," ",e.behindCount," behind)")}))))},Ke=n(116),Ue=function(e){return e.visible?c.a.createElement(c.a.Fragment,null,Object.keys(e.variables||{}).map((function(t){return c.a.createElement(Ve.a,{key:t,label:t,labelFor:"var_".concat(t)},c.a.createElement(Ke.a,{id:"var_".concat(t),"data-lpignore":"true",autoComplete:"off",readOnly:!0,value:e.variables[t].value,onChange:function(){}}))}))):null},Xe=function(e){var t=Object(r.useReducer)(Ye,{visible:!1,branches:[],branch:"",loading:!1}),n=Object(ve.a)(t,2),a=n[0],i=a.branch,o=a.branches,u=a.loading,l=a.visible,s=n[1],p=R("repositoryService","buildService","organizationId","projectId","tenantId"),d=p.repositoryService,m=p.buildService,h=p.tenantId,b=p.organizationId,E=p.projectId,g=function(){var t=Object(v.a)(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s({visible:!0,loading:!0}),t.next=3,d.listBranches(h,b,E,e.repository.id);case 3:if(t.t0=t.sent,t.t0){t.next=6;break}t.t0=[];case 6:t.t1=W,n=t.t0.sort(t.t1),s({branches:n,loading:!1,branch:n.length>0?n[0].name:""});case 9:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),y=function(){var t=Object(v.a)(f.a.mark((function t(){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={queue:{id:e.queue.id},definition:{id:e.id},project:{id:E},sourceBranch:"refs/heads/".concat(i),sourceVersion:"",reason:1,demands:[],parameters:JSON.stringify(xe(e.variables))},t.next=3,m.trigger(h,b,n);case 3:Z("Build queued","success","cog"),s({visible:!1});case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),j="TfsGit"!==e.repository.type;return c.a.createElement(c.a.Fragment,null,c.a.createElement(Be,{icon:"play",intent:"primary",onClick:g,tooltip:j?"Builds are not supported for repository type ".concat(e.repository.type):"Queue build for ".concat(e.name),disabled:j}),c.a.createElement(we.a,{isOpen:l,onClose:function(){return s({visible:!1})},className:"bp3-dark"},c.a.createElement(Pe,{content:"Queue new build for ".concat(e.name)}),c.a.createElement(Te,null,c.a.createElement(Qe,{size:ue.a.SIZE_LARGE,hidden:!u}),c.a.createElement(Je,{hidden:u||o.length>0,title:"No branches found"}),c.a.createElement($e,{loading:u,branches:o,onChange:function(e){return s({branch:e})}}),c.a.createElement(Ue,{variables:e.variables,visible:!u&&o.length>0})),c.a.createElement(Re,null,c.a.createElement(Be,{text:"Cancel",onClick:function(){return s({visible:!1})}}),c.a.createElement(Be,{disabled:0===o.length,intent:"primary",text:"Queue build",onClick:y}))))},et=function(e){var t=e.step,n=Object(r.useState)(!1),a=Object(ve.a)(n,2),i=a[0],o=a[1];return c.a.createElement("div",null,c.a.createElement("h3",null,c.a.createElement(_e.a,{minimal:!0,rightIcon:i?"arrow-down":"arrow-right",onClick:function(){return o(!i)}},"Step: ",t.displayName)),i&&Object.keys(t.inputs).map((function(e){return c.a.createElement(Ve.a,{key:e,label:e,labelFor:e},c.a.createElement(Ke.a,{id:e,placeholder:t.inputs[e].toString(),readOnly:!0}))})))},tt=function(e){var t=e.phase;return c.a.createElement(c.a.Fragment,null,c.a.createElement("h2",null,"Phase: ",t.name),Object.keys(t.target.executionOptions).map((function(e){return c.a.createElement(Ve.a,{key:e,label:e,labelFor:e},c.a.createElement(Ke.a,{id:e,placeholder:t.target.executionOptions[e].toString(),readOnly:!0}))})),t.steps.map((function(e){return c.a.createElement(et,{key:"".concat(t.refName,"_").concat(e.displayName),step:e})})))},nt=function(e){var t=Object(r.useState)(!1),n=Object(ve.a)(t,2),a=n[0],i=n[1];return c.a.createElement(c.a.Fragment,null,c.a.createElement(Be,{tooltip:"View build definition",icon:"code-block",onClick:function(){return i(!0)}}),c.a.createElement(we.a,{isOpen:a,onClose:function(){return i(!1)},className:"bp3-dark scroll-dialog large-dialog"},c.a.createElement(Pe,{content:"Build process"}),c.a.createElement(Te,null,e.process.yamlFilename&&c.a.createElement("div",null,"This pipeline is defined in"," ",e.process.yamlFilename),e.process.phases&&e.process.phases.map((function(e){return c.a.createElement(tt,{key:e.refName,phase:e})})))))},at=Object(r.memo)((function(e){var t=e.definition;return c.a.createElement("tr",{key:t.id},c.a.createElement("td",null,t.name),c.a.createElement("td",null,t.path),c.a.createElement("td",null,t.repository.name),c.a.createElement("td",null,t.latestBuild&&c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce,{result:t.latestBuild.result,status:t.latestBuild.status}),t.latestBuild.buildNumber)),c.a.createElement("td",null,c.a.createElement(Oe.a,null,c.a.createElement(qe,{id:t.id,name:t.name}),c.a.createElement(nt,{process:t.process}),c.a.createElement(Xe,{id:t.id,name:t.name,repository:t.repository,variables:t.variables,queue:t.queue}))))})),rt=function(){var e=R("buildService","tenantId","organizationId","projectId"),t=e.buildService,n=e.tenantId,a=e.organizationId,i=e.projectId,o=q("projects"),u=Object(r.useState)(!0),l=Object(ve.a)(u,2),s=l[0],p=l[1],d=Object(r.useState)([]),m=Object(ve.a)(d,2),h=m[0],b=m[1],E=function(){var e=Object(v.a)(f.a.mark((function e(){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&a&&i){e.next=2;break}return e.abrupt("return");case 2:return p(!0),e.next=5,t.listDefinitions(n,a,i);case 5:r=e.sent,b(r),p(!1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){E();var e=window.setInterval((function(){E()}),6e4);return function(){return window.clearInterval(e)}}),[i]),s||o?c.a.createElement(ue.a,{size:ue.a.SIZE_LARGE}):c.a.createElement("div",null,c.a.createElement(Be,{icon:"refresh",disabled:s,tooltip:"Refresh builds",onClick:E}),c.a.createElement(Ee.a,{bordered:!0,striped:!0,style:{width:"100%"}},c.a.createElement(je,null,c.a.createElement("th",null,"Name"),c.a.createElement("th",null,"Path"),c.a.createElement("th",null,"Repository"),c.a.createElement("th",null,"Latest build"),c.a.createElement("th",null)),c.a.createElement("tbody",null,c.a.createElement(ye,{columns:5,text:"This project does not have any builds defined",visible:0===h.length}),h.sort(K).map((function(e){return c.a.createElement(at,{key:e.id,definition:e})})))))},ct=n(117),it=n(118),ot=ke(0,24).map((function(e){return{key:e,value:e,text:e.toString()}})),ut=ke(0,4,15).map((function(e){return{key:e,value:e,text:e.toString()}})),lt=function(){var e=new Date;return e.setMonth(e.getMonth()+1),e},st=function(e){var t=Object(r.useState)(!1),n=Object(ve.a)(t,2),a=n[0],i=n[1],o=Object(r.useState)(!1),u=Object(ve.a)(o,2),l=u[0],s=u[1];if(0===e.approvals.length)return null;var p=1===e.approvals.length?e.approvals[0].releaseEnvironment.name:"Approve multiple",d=e.approvals.length>1,m=1===e.approvals.length?"Approve release to ".concat(e.approvals[0].releaseEnvironment.name):"Select releases to approve";return c.a.createElement(c.a.Fragment,null,c.a.createElement(Be,{text:p,tooltip:m,onClick:function(){return i(!0)}}),c.a.createElement(we.a,{isOpen:a,onClose:function(){return i(!1)},className:"bp3-dark"},c.a.createElement(Pe,{content:"Approve release"}),c.a.createElement(Te,null,e.approvals.map((function(e){return c.a.createElement("div",{key:e.id},d&&c.a.createElement(ct.a,null),e.releaseDefinition.name," to"," ",e.releaseEnvironment.name)})),c.a.createElement("div",null,c.a.createElement(ct.a,{title:"Defer release",checked:l,onChange:function(){return s(!l)}},"Defer release")),l&&c.a.createElement("div",null,c.a.createElement(it.a,{locale:"sv-se",dayPickerProps:{firstDayOfWeek:1},minDate:new Date,maxDate:lt()}),c.a.createElement(le,{loading:!1,value:0,items:ot,onChange:function(){},noData:""}),c.a.createElement(le,{loading:!1,value:0,items:ut,onChange:function(){},noData:""}))),c.a.createElement(Re,null,c.a.createElement(Be,{text:"Cancel",onClick:function(){return i(!1)}}),c.a.createElement(Be,{intent:"primary",text:"Approve"}))))},pt=function(){return c.a.createElement(Be,{tooltip:"View release definition",icon:"code-block"})},dt=function(){return c.a.createElement(Be,{tooltip:"View history",icon:"history"})},mt=function(){return c.a.createElement(Be,{icon:"play",intent:"primary",tooltip:"Create new release"})},ft=function(e){var t=e.definition,n=e.approvals;return c.a.createElement("tr",null,c.a.createElement("td",null,t.name),c.a.createElement("td",null,t.path),c.a.createElement("td",null,n.map((function(e){return c.a.createElement(st,{key:e.id,approvals:[e]})}))),c.a.createElement("td",null,c.a.createElement(dt,null),c.a.createElement(pt,null),c.a.createElement(mt,null)))},vt=function(){var e=R("releaseService","tenantId","organizationId","projectId"),t=e.releaseService,n=e.tenantId,a=e.organizationId,i=e.projectId,o=q("projects"),u=Object(r.useState)(!0),l=Object(ve.a)(u,2),s=l[0],p=l[1],d=Object(r.useState)([[],[]]),m=Object(ve.a)(d,2),h=m[0],b=m[1],E=function(){var e=Object(v.a)(f.a.mark((function e(){var r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&a&&i){e.next=2;break}return e.abrupt("return");case 2:return p(!0),e.t0=Promise,e.next=6,t.listDefinitions(n,a,i);case 6:return e.t1=e.sent,e.next=9,t.listApprovals(n,a,i);case 9:return e.t2=e.sent,e.t3=[e.t1,e.t2],e.next=13,e.t0.all.call(e.t0,e.t3);case 13:r=e.sent,b(r),p(!1);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(Object(r.useEffect)((function(){E();var e=window.setInterval((function(){s||o||E()}),6e4);return function(){return window.clearInterval(e)}}),[i]),s||o)return c.a.createElement(ue.a,{size:ue.a.SIZE_LARGE});var g=Object(ve.a)(h,2),y=g[0],j=g[1];return c.a.createElement("div",null,c.a.createElement(Oe.a,null,c.a.createElement(Be,{icon:"refresh",disabled:s,tooltip:"Refresh builds",onClick:E}),j.length>1&&c.a.createElement(st,{approvals:j})),c.a.createElement(Ee.a,{bordered:!0,striped:!0,style:{width:"100%"}},c.a.createElement(je,null,c.a.createElement("th",null,"Name"),c.a.createElement("th",null,"Path"),c.a.createElement("th",null,"Approvals"),c.a.createElement("th",null)),c.a.createElement("tbody",null,c.a.createElement(ye,{columns:4,text:"This project does not have any releases defined",visible:0===y.length}),y.sort(U).map((function(e){return c.a.createElement(ft,{key:e.id,definition:e,approvals:j.filter((function(t){return t.releaseDefinition.id===e.id}))})})))))},ht=function(){var e=(window.location.hash||"builds").split("/"),t=Object(r.useState)("#"+e[e.length-1]),n=Object(ve.a)(t,2),a=n[0],i=n[1];return c.a.createElement(he.a,{selectedTabId:a,onChange:function(e){i(e.toString());var t=window.location.hash.split("/");t[t.length-1]=e.toString().substr(1),window.location.hash=t.join("/")}},c.a.createElement(be.a,{id:"#builds",title:"Builds",panel:c.a.createElement(rt,null)}),c.a.createElement(be.a,{id:"#releases",title:"Releases",panel:c.a.createElement(vt,null)}))},bt=function(){var e=q("tenants");return c.a.createElement("div",{className:"bp3-dark app-root"},c.a.createElement(we.a,{isOpen:!0,className:"bp3-dark"},c.a.createElement(Pe,{content:"Please log in"}),c.a.createElement(Te,null,e&&c.a.createElement(ue.a,{size:ue.a.SIZE_LARGE}),c.a.createElement(_e.b,{icon:"log-in",text:"Click here to sign in to your Microsoft Account",onClick:function(){te()},disabled:e}))))},Et=function(){var e={organizations:q("organizations"),projects:q("projects")},t=R("organizations","tenantId","tenants"),n=t.organizations,a=t.tenantId,i=t.tenants,o=Object(r.useState)(!1),u=Object(ve.a)(o,2),l=u[0],s=u[1],p=i.find((function(e){return e.tenantId===a}));if(Object(r.useEffect)((function(){s(!e.organizations&&!e.projects&&0===n.length)}),[e.organizations,e.projects,n]),!p)return null;return c.a.createElement(we.a,{isOpen:l,className:"bp3-dark"},c.a.createElement(Pe,{content:"Filter current tenant?"}),c.a.createElement(Te,null,'The tenant "',p.displayName,'" does not appear to have any Azure DevOps organizations, would you like to add a filter to remove it?'),c.a.createElement(Re,null,c.a.createElement(_e.b,{text:"Cancel",onClick:function(){return s(!1)}}),c.a.createElement(_e.b,{text:"Ok",intent:"primary",onClick:function(){ee(p),s(!1)}})))},gt=function(){return R("account").account?c.a.createElement("div",{className:"bp3-dark app-root"},c.a.createElement(fe,null),c.a.createElement(ht,null),c.a.createElement(Et,null)):c.a.createElement(bt,null)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(gt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},79:function(e,t,n){e.exports=n(106)},87:function(e,t,n){}},[[79,1,2]]]);
//# sourceMappingURL=main.397b3ee5.chunk.js.map